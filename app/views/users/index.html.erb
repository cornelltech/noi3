<!-- TODO: Default to current user if current_user, else default to sign on screen-->
<%# if user_signed_in? %>
  <%# render 'profile', { user: current_user  }%>
  <%# render 'projects', { user: current_user  }%>
  <%# render 'events', { user: current_user }%>
  <%# render 'expertise', { user: current_user  }%>

<% if user_signed_in? %>
  <div class="profile-panel panel panel--1">
      <%= render 'profile', { user: current_user  }%>
  </div>
  <div class="project-panel panel panel--2">
      <%= render 'projects', { user: current_user  }%>
  </div>
  <div class="event-panel panel panel--3">
      <%= render 'events', { user: current_user }%>
  </div>
  <div class="expertise-panel panel panel--4">
      <%= render 'expertise', { user: current_user  }%>
  </div>
<% else %>
<%= render 'devise/registrations/new' %>
<% end %>

<div class="main-content search-page">
  <div class="toast toast--yellow"> 
  <!-- {# toast--green, toast--red, toast--gray #} -->
    <i class="material-icons toast__close">close</i>
    <h4 class="toast__heading">Titles donâ€™t say enough</h4>
    <p class="toast__text">Find experts to contact based on their innovation experience</p>
  </div>

  <article class="main-content__container">
    <section class="filter-section">
      <form action="" class="form">
        <div class="search search--fixed js-target-search find-innovator" action="">
          <input class="search__field" type="text" placeholder="Find an Innovator">
          <input class="js-search-submit js-trigger-search search-trigger" type="submit" value="search">
        </div>
        <p><em class="highlighted-or">OR</em> Find someone with experience in 
        <span class="select select--inline select-innovation-area">
          <select name="" id="">
            <option value="">Pick an Innovation Area</option>
            
            <% @categories.each do |category|  %>
              <option value=""><%= category %></option>
            <% end %>

          </select>
        </span>
        <span class="select select--inline select-innovation-area" disabled>
          <select name="" id="">
            <option value="">Pick an Innovation Area</option>
            <option value="">Open Data</option>
            <option value="">Crowdsourcing</option>
          </select>
        </span>
      </form>
    <!-- <section class="active-filters">
      <span class="filter-by">Filter by</span>
      <span class="active-filters__item">Location</span>
      <span class="active-filters__item">Field of Work</span>
      <span class="active-filters__item">Language</span>
    </section> -->
    </section>
    
    <ul class="list">
      <% @users.each do | user | %>
      <li class="list__item person-item">
        <%# image_tag('users/' + user.picture_path, :alt => "User", :class => "person-item__picture") %>
        <!-- PLACEHOLDER IMAGE -->
        <%= image_tag('users/128.jpg', :alt => "User", :class => "person-item__picture") %>
        <div class="person-item__content">
          <%= link_to (url_for({:controller => "users", :action => "fetch_user", :user_id => user.id})), :remote => true do %>
          <hgroup class="person-item__credentials" data-user="<%=user.id%>">
            <h2 class="person-item__name"><%= user.first_name %> <%= user.last_name %></h2>

            <h3 class="person-item__job"><%= user.position %></h3>
            <h4 class="person-item__org"><%= user.organization%></h4>
          </hgroup>
          <% end %>
          <div class="person-item__controls">
            <i class="person-item__pm material-icons controls__icon-button">mail_outline</i>
          </div>
        </div>
        <div class="person-item__content">
          <ul class="person-item__tags category-tags">
            <% user.format_expertise.each do |e| %>
              <li class="category-tag">
                <span class="category-tag__main"><%= e[:category].titleize %></span>
                <% e[:skill_areas].each do |skill_area| %>
                <span class="category-tag__sub"><%= skill_area.titleize %></span>
                <% end %>
                </li>
            <% end %>
          </ul>
          <div class="person-item__controls">
            <a href="#" class="person-item__projects controls__button"><%=user.projects.count %> Projects</a>
          </div>
        </div>
        
      </li>
      <% end %>
    </ul>
</article>
  
</div>